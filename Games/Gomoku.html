<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="description" content="Gomoku · 五子棋 · 极简渐变、顺滑动画、支持深浅色主题"/>
  <title>Gomoku</title>

  <link href="https://fonts.googleapis.com/css2?family=Exo:wght@700&family=Montserrat:wght@400;500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      /* 全站主题变量（与 Snake 一致） */
      --bg-0:#0f1c24; --bg-1:#324450; --tx-0:#d8e9f0; --tx-1:#b8c7d6;
      --pri-0:#00e0ff; --pri-1:#9caedb;
      --card-bg:rgba(10,20,28,.55);
      --card-shadow:0 12px 32px rgba(0,224,255,.14);
      --card-shadow-hover:0 16px 48px rgba(0,224,255,.22);
      --focus:0 0 0 3px rgba(0,224,255,.35);
      --rad-xl:24px; --rad-lg:16px;

      /* 棋盘变量（JS 读取 --pad） */
      --cell: clamp(26px, 3.2vw, 36px);
      --pad: 14px;
      --line: rgba(255,255,255,.18);

      /* 浅色主题黑棋描边强度（可按需调） */
      --black-ring-alpha:.50;
      --black-ring-glow:.22;

      /* 居中所用导航高度（JS 会覆盖成真实值） */
      --nav-h:72px;
    }
    body.dark-theme{
      --bg-0:#2a1400; --bg-1:#b64b00; --tx-0:#fff2e2; --tx-1:#ffe3c7;
      --pri-0:#ff7a00; --pri-1:#ffd28a;
      --card-bg:rgba(56,24,0,.55);
      --card-shadow:0 12px 32px rgba(255,122,0,.20);
      --card-shadow-hover:0 16px 48px rgba(255,122,0,.30);
      --focus:0 0 0 3px rgba(255,122,0,.4);
      --line: rgba(255,255,255,.22);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:'Montserrat',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--tx-0);
      background:linear-gradient(180deg,var(--bg-0) 0%,var(--bg-1) 100%);
      overflow-x:hidden; transition:background .45s ease,color .45s ease; animation:fadeIn 1s ease both;
      -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    }
    @keyframes fadeIn{from{opacity:.0}to{opacity:1}}
    a{color:inherit; text-decoration:none}
    button{font:inherit; cursor:pointer}

    /* 顶栏（Home / Snake / Gomoku） */
    nav{
      position:sticky; top:0; z-index:100; display:flex; gap:20px; justify-content:center; align-items:center;
      padding:16px 20px; transition:all .3s ease; background:transparent;
    }
    nav.scrolled{background:rgba(0,0,0,.25); backdrop-filter:blur(10px); padding:10px 20px}
    nav ul{display:flex; list-style:none; gap:24px; padding:0; margin:0}
    nav a{position:relative; font-weight:600; opacity:.95}
    nav a::after{content:''; position:absolute; left:0; bottom:-6px; height:2px; width:0;
      background:linear-gradient(90deg,var(--pri-0),var(--pri-1)); transition:width .25s ease;}
    nav a:hover::after, nav a[aria-current="page"]::after{width:100%}
    #theme-toggle{
      background:linear-gradient(135deg,var(--pri-0),var(--pri-1)); color:#0a1a22; border:none; border-radius:999px;
      padding:8px 14px; font-weight:700; transition:transform .25s ease, box-shadow .25s ease;
    }
    #theme-toggle:hover{transform:translateY(-1px); box-shadow:0 8px 18px rgba(0,0,0,.25)}
    #theme-toggle:focus-visible{outline:none; box-shadow:var(--focus)}

    /* ===== CSS 垂直居中：标题+卡片整体在首屏居中 ===== */
    main{
      min-height: calc(100svh - var(--nav-h));
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    /* 标题区 */
    .hero{text-align:center; padding:40px 20px 26px;}
    .hero h1{
      margin:0 0 8px; font-size:40px; font-weight:800; font-family:'Exo',sans-serif;
      background:linear-gradient(90deg,var(--pri-0),var(--pri-1));
      -webkit-background-clip:text; -webkit-text-fill-color:transparent;
    }
    .hero p{margin:0 auto; max-width:560px; color:var(--tx-1)}

    /* 内容卡片布局（与 Snake 相同风格） */
    .game-grid{width:min(1100px,92vw); margin:0 auto; padding:32px 20px}
    .game-card{
      background:var(--card-bg); border-radius:var(--rad-xl); box-shadow:var(--card-shadow);
      padding:18px; text-align:center; transition:transform .35s ease, box-shadow .35s ease, opacity .6s ease-out;
      opacity:0; transform:translateY(24px); border:none; margin:0 auto; max-width:820px;
    }
    .game-card.visible{opacity:1; transform:translateY(0)}
    .game-card:hover{transform:translateY(-10px); box-shadow:var(--card-shadow-hover)}

    /* HUD 与按钮 */
    #hud{margin-bottom:12px; font-size:16px; font-weight:600; color:var(--tx-0)}
    #hud span{margin:0 12px}
    .buttons{ display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin-bottom:8px }
    .pill, .select{ border-radius:999px; padding:8px 14px; font-weight:700; border:none; }
    .pill{
      background:linear-gradient(135deg,var(--pri-0),var(--pri-1)); color:#0a1a22;
      transition:transform .25s ease, box-shadow .25s ease;
    }
    .pill:hover{transform:translateY(-1px); box-shadow:0 8px 18px rgba(0,0,0,.25)}
    .pill:focus-visible{outline:none; box-shadow:var(--focus)}
    .select{ background:rgba(255,255,255,.12); color:var(--tx-0); border:1px solid rgba(255,255,255,.18); padding-right:28px; }

    /* 游戏舞台容器 */
    #gomoku-stage{
      margin:0 auto 16px; border-radius:var(--rad-lg); overflow:hidden; box-shadow:0 6px 18px rgba(0,0,0,.25);
      width:100%; max-width:640px; aspect-ratio:1/1; display:flex; align-items:center; justify-content:center;
      background:rgba(0,0,0,.18); position:relative;
    }

    /* 棋盘（你的 JS 会 append .cell） */
    #board{
      position:relative; display:grid; gap:0;
      grid-template-columns:repeat(15,var(--cell));
      grid-template-rows:repeat(15,var(--cell));
      padding:var(--pad); border-radius:16px; isolation:isolate;
      width:100%; height:100%;
      background: linear-gradient(180deg, rgba(255,255,255,.05) 0%, rgba(255,255,255,.02) 100%);
      box-shadow: inset 0 8px 20px rgba(0,0,0,.15), 0 10px 22px rgba(0,0,0,.08);
    }
    /* 网格线（用 --line，主题联动） */
    #board::before{
      content:""; position:absolute; inset:var(--pad);
      background-image:
        linear-gradient(to right, var(--line) 1px, transparent 1px),
        linear-gradient(to bottom,var(--line) 1px, transparent 1px);
      background-size:var(--cell) var(--cell), var(--cell) var(--cell);
      pointer-events:none; border-radius:10px; opacity:.95;
    }

    /* ========= 浅色（蓝）主题：加深棋盘 + 黑棋蓝描边 ========= */
    /* 棋盘冷灰蓝加深 & 网格线加深 */
    body:not(.dark-theme){ --line: rgba(0, 35, 60, .22); }
    body:not(.dark-theme) #board{
      background:
        radial-gradient(120% 100% at 18% 8%, #c5d6e0 0%, #a5b8c6 45%, #8a9cab 100%),
        repeating-linear-gradient(18deg, rgba(0, 96, 160, .08) 0 3px, rgba(0,0,0,.10) 3px 6px),
        repeating-linear-gradient(-18deg, rgba(0, 96, 160, .06) 0 4px, rgba(0,0,0,.12) 4px 8px);
      box-shadow: inset 0 10px 28px rgba(0, 96, 160, .18), 0 12px 30px rgba(0,0,0,.18);
    }
    /* 黑棋蓝色描边与柔光（只在浅色） */
    body:not(.dark-theme) .cell.black::before{
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,.06),
        0 0 0 2px rgba(0, 224, 255, var(--black-ring-alpha)),
        0 6px 16px rgba(0, 60, 100, .35),
        0 0 14px rgba(0, 224, 255, var(--black-ring-glow));
    }
    /* 玩家上一步蓝圈更明显 */
    body:not(.dark-theme) .cell.last-move::after{
      box-shadow: 0 0 0 6px rgba(0, 224, 255, .35), 0 0 18px 8px rgba(0, 224, 255, .45);
    }

    /* 棋子外观与动效 */
    .cell{ position:relative; width:var(--cell); height:var(--cell) }
    .cell:hover::after{ content:none !important; } /* 禁预下影 */
    .cell.black::before, .cell.white::before{
      content:""; position:absolute; inset:4px; border-radius:50%;
      transform:translateY(-10px) scale(.9); opacity:0;
      animation:drop .26s cubic-bezier(.22,.75,.22,1.05) forwards;
    }
    .cell.black::before{
      background:radial-gradient(120% 120% at 35% 30%, #5a5a5a 0%, #1e1e1e 45%, #0a0a0a 100%);
    }
    .cell.white::before{
      background:radial-gradient(120% 120% at 35% 30%, #fff 0%, #efefef 50%, #dedede 100%);
      box-shadow: inset 0 0 0 2px rgba(0,0,0,.09), 0 4px 10px rgba(0,0,0,.2);
    }

    /* AI 上一步呼吸光效（浅色蓝 / 深色橙主题联动写在下面） */
    .cell.ai-last-move::after{
      content:"";position:absolute;inset:0;border-radius:50%;pointer-events:none;
      background: radial-gradient(circle at 50% 50%,
                  rgba(0,224,255,.85) 0 34%,
                  rgba(156,174,219,.22) 34% 52%,
                  rgba(156,174,219,0) 52% 100%);
      box-shadow: 0 0 0 5px rgba(0,224,255,.32),
                  0 0 18px 8px rgba(0,224,255,.45),
                  0 0 38px 16px rgba(156,174,219,.28);
      filter:saturate(1.05); mix-blend-mode:screen;
      animation: aiPulse 1.2s ease-in-out infinite, aiFlash 700ms ease-out 1; opacity:.95;
    }

    /* 胜利线 */
    .win-line{ position:absolute; inset:0; pointer-events:none }
    .win-line line{
      stroke:#00e0ff; stroke-width:5; stroke-linecap:round;
      filter:drop-shadow(0 0 6px rgba(0,224,255,.55));
      stroke-dasharray:440; stroke-dashoffset:440; animation:draw 420ms ease-out forwards;
    }

    /* 深色主题：暗金木纹 + 黑棋金描边 + 橙色胜利线 */
    body.dark-theme #board{
      background:
        radial-gradient(120% 100% at 18% 8%, #2a2018 0%, #1b1510 45%, #120e0b 100%),
        repeating-linear-gradient(18deg, rgba(212,167,44,.07) 0 3px, rgba(0,0,0,.18) 3px 6px),
        repeating-linear-gradient(-18deg, rgba(212,167,44,.05) 0 4px, rgba(0,0,0,.22) 4px 8px);
      box-shadow: inset 0 10px 30px rgba(212,167,44,.08), 0 12px 30px rgba(0,0,0,.55);
    }
    body.dark-theme .cell.black::before{
      background:radial-gradient(120% 120% at 35% 30%, #6a6a6a 0%, #242424 45%, #0a0a0a 100%);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,.08),
        0 0 0 2px rgba(212,167,44,.45),
        0 6px 16px rgba(0,0,0,.66);
    }
    body.dark-theme .cell.white::before{
      box-shadow: inset 0 0 0 2px rgba(255,255,255,.10), 0 4px 12px rgba(0,0,0,.55);
    }
    body.dark-theme .cell.ai-last-move::after{
      background: radial-gradient(circle at 50% 50%,
                  rgba(255,122,0,.88) 0 34%,
                  rgba(255,210,138,.24) 34% 52%,
                  rgba(255,210,138,0) 52% 100%);
      box-shadow: 0 0 0 5px rgba(255,122,0,.35),
                  0 0 18px 8px rgba(255,122,0,.55),
                  0 0 38px 16px rgba(255,210,138,.30);
    }
    body.dark-theme .win-line line{
      stroke:#ff7a00; filter:drop-shadow(0 0 6px rgba(255,122,0,.6));
    }

    @keyframes drop{to{transform:translateY(0) scale(1); opacity:1}}
    @keyframes aiPulse{0%{transform:scale(.92);opacity:.85}50%{transform:scale(1.05);opacity:1}100%{transform:scale(.92);opacity:.85}}
    @keyframes aiFlash{
      0%{box-shadow:0 0 0 0 rgba(0,224,255,.6), 0 0 0 0 rgba(156,174,219,.35), 0 0 0 0 rgba(156,174,219,.2)}
      60%{box-shadow:0 0 0 10px rgba(0,224,255,0), 0 0 18px 10px rgba(0,224,255,.35), 0 0 38px 20px rgba(156,174,219,.25)}
      100%{box-shadow:0 0 0 6px rgba(0,224,255,.32), 0 0 18px 8px rgba(0,224,255,.45), 0 0 38px 16px rgba(156,174,219,.28)}
    }
    @keyframes draw{to{stroke-dashoffset:0}}

    /* 响应式 */
    @media (max-width:768px){
      .hero h1{font-size:32px}
      nav ul{gap:16px; flex-wrap:wrap; justify-content:center}
    }
    @media (prefers-reduced-motion:reduce){
      *,*:before,*:after{transition:none !important; animation:none !important}
      .game-card{opacity:1 !important; transform:none !important}
    }
  </style>
</head>
<body>
  <!-- 顶栏 -->
  <nav role="navigation" aria-label="主导航">
    <ul>
      <li><a href="/index.html">Home</a></li>
      <li><a href="/Games/snake.html">Snake</a></li>
      <li><a href="/Games/Gomoku.html" aria-current="page">Gomoku</a></li>
    </ul>
    <button id="theme-toggle" aria-label="切换主题" aria-pressed="false">切换主题</button>
  </nav>

  <main>
    <!-- 标题区 -->
    <section class="hero" role="banner">
      <h1>Gomoku</h1>
      <p>极简块状像素与顺滑动画。连接五子即胜，支持难度切换与深浅色主题。</p>
    </section>

    <div class="game-grid">
      <div class="game-card">
        <!-- HUD：JS 使用 #message -->
        <div id="hud" aria-live="polite">
          <span id="message">Your turn (Black)</span>
        </div>

        <!-- 控件：ID 必须匹配 JS -->
        <div class="buttons" role="group" aria-label="Gomoku 控件">
          <label for="difficulty-select" class="visually-hidden" style="position:absolute;left:-9999px;">Difficulty</label>
          <select id="difficulty-select" class="select" title="Difficulty">
            <option value="easy">Easy</option>
            <option value="medium" selected>Medium</option>
            <option value="hard">Hard</option>
          </select>
          <button id="new-game" class="pill">新局</button>
        </div>

        <!-- 游戏舞台：JS 依赖 #gomoku / #board / #win-svg -->
        <section id="gomoku" aria-label="Gomoku">
          <div id="gomoku-stage">
            <svg class="win-line" id="win-svg"></svg>
            <div id="board" role="grid" aria-label="15×15 五子棋棋盘"></div>
          </div>
        </section>

        <h2 style="font:700 22px 'Exo',sans-serif; margin:4px 0 6px">Gomoku</h2>
        <p style="font-size:14px; color:var(--tx-1); margin:0 0 8px">Connect five in a row. Clean visuals · Smooth animations · Smart AI.</p>
      </div>
    </div>
  </main>

  <!-- 你的 AI/逻辑脚本（确认此路径指向你的 Gomoku.js） -->
  <script defer src="/JS_Codes/Gomoku.js"></script>

  <script>
    /* 主题持久化 + 按钮逻辑 */
    const THEME_KEY='retroIndexTheme';
    const applyTheme=(t)=>{
      const dark = t==='dark';
      document.body.classList.toggle('dark-theme', dark);
      document.getElementById('theme-toggle')?.setAttribute('aria-pressed', String(dark));
    };
    (()=>{
      const saved=localStorage.getItem(THEME_KEY);
      const prefersDark=window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      applyTheme(saved || (prefersDark?'dark':'light'));
    })();
    document.getElementById('theme-toggle')?.addEventListener('click',()=>{
      const dark=!document.body.classList.contains('dark-theme');
      applyTheme(dark?'dark':'light');
      localStorage.setItem(THEME_KEY, dark?'dark':'light');
    });

    /* 滚动吸顶（与 Snake 一致） */
    let ticking=false;
    window.addEventListener('scroll',()=>{
      if(!ticking){
        requestAnimationFrame(()=>{
          const nav=document.querySelector('nav');
          if(window.scrollY>100) nav?.classList.add('scrolled'); else nav?.classList.remove('scrolled');
          ticking=false;
        }); ticking=true;
      }
    });

    /* 卡片出现动画 */
    const io=new IntersectionObserver(es=>{
      es.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('visible'); io.unobserve(e.target);} });
    },{threshold:.2});
    document.querySelectorAll('.game-card').forEach(c=>io.observe(c));

    /* 用真实导航高度校准首屏居中（更精准） */
    const navH = document.querySelector('nav')?.offsetHeight || 72;
    document.documentElement.style.setProperty('--nav-h', navH + 'px');
  </script>
</body>
</html>
